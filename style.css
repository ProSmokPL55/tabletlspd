let citizens = [];
let officers = [];

// Tab switching
function openTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    document.querySelector(`.tab-btn[onclick="openTab('${tabName}')"]`).classList.add('active');
}

// Citizen functions
function addCitizen() {
    const first = document.getElementById('citizenFirst').value;
    const last = document.getElementById('citizenLast').value;
    const photo = document.getElementById('citizenPhoto').value;
    if (!first || !last) return alert("Podaj imię i nazwisko!");
    const ssn = Math.floor(100000000 + Math.random() * 900000000);
    citizens.push({first, last, photo, ssn, notes: [], wanted: 0, searches: []});
    displayCitizens();
    document.getElementById('citizenFirst').value='';
    document.getElementById('citizenLast').value='';
    document.getElementById('citizenPhoto').value='';
}

function displayCitizens() {
    const list = document.getElementById('citizenList');
    list.innerHTML = '';
    citizens.forEach(c => {
        const card = document.createElement('div');
        card.className = 'citizen-card';
        card.innerHTML = `
            <img src="${c.photo || 'https://via.placeholder.com/70'}" alt="photo">
            <div>
                <strong>${c.first} ${c.last}</strong> (SSN: ${c.ssn})<br>
                Wanted: <span class="wanted">${'★'.repeat(c.wanted)}</span><br>
                Notatki: ${c.notes.join(', ')}
            </div>
        `;
        list.appendChild(card);
    });
}

function searchCitizen() {
    const query = document.getElementById('searchInput').value.toLowerCase();
    const results = document.getElementById('searchResults');
    results.innerHTML = '';
    citizens.filter(c => c.first.toLowerCase().includes(query) || c.last.toLowerCase().includes(query))
        .forEach(c => {
            const card = document.createElement('div');
            card.className = 'citizen-card poszukiwanie';
            card.innerHTML = `
                <img src="${c.photo || 'https://via.placeholder.com/70'}" alt="photo">
                <div>
                    <strong>${c.first} ${c.last}
